<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù…ØªØ·ÙˆØ±</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap');
    
    :root {
      --primary-color: #128c7e;
      --primary-dark: #075e54;
      --primary-light: #25d366;
      --user-message: #dcf8c6;
      --bot-message: #ffffff;
      --background: #f0f2f5;
      --text-primary: #3c4043;
      --text-secondary: #5f6368;
      --border-color: #dadce0;
      --shadow: 0 1px 3px rgba(0, 0, 0, 0.12);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Tajawal', sans-serif;
    }
    
    body {
      background: var(--background);
      color: var(--text-primary);
      direction: rtl;
      height: 100vh;
      overflow: hidden;
    }
    
    #app {
      max-width: 1000px;
      margin: 0 auto;
      height: 100vh;
      display: flex;
      flex-direction: column;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      background: white;
      position: relative;
    }
    
    /* Ø§Ù„Ø±Ø£Ø³ Ø§Ù„Ù…Ø­Ø³Ù† */
    header {
      height: 70px;
      background: linear-gradient(to right, var(--primary-dark), var(--primary-color));
      color: white;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 25px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      z-index: 100;
    }
    
    .header-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .logo {
      width: 40px;
      height: 40px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      color: var(--primary-dark);
    }
    
    .app-title h1 {
      font-size: 1.4rem;
      font-weight: 700;
    }
    
    .app-title p {
      font-size: 0.8rem;
      opacity: 0.9;
    }
    
    .header-actions {
      display: flex;
      gap: 15px;
    }
    
    .header-btn {
      background: rgba(255, 255, 255, 0.2);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      color: white;
      font-size: 18px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .header-btn:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: scale(1.05);
    }
    
    /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© Ø§Ù„Ù…Ø­Ø³Ù†Ø© */
    #sidebar {
      position: fixed;
      top: 70px;
      right: 0;
      width: 300px;
      height: calc(100vh - 70px);
      background: white;
      box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
      padding: 20px;
      box-sizing: border-box;
      overflow-y: auto;
      transform: translateX(100%);
      transition: transform 0.3s ease;
      z-index: 90;
    }
    
    #sidebar.visible {
      transform: translateX(0);
    }
    
    .sidebar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .sidebar-header h2 {
      font-size: 1.3rem;
      color: var(--primary-dark);
    }
    
    .close-sidebar {
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--text-secondary);
      cursor: pointer;
    }
    
    #new-chat-btn {
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 25px;
      padding: 10px 20px;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-bottom: 20px;
      width: 100%;
    }
    
    #new-chat-btn:hover {
      background: var(--primary-dark);
    }
    
    #chat-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    #chat-list li {
      padding: 12px 15px;
      background: white;
      margin-bottom: 8px;
      cursor: pointer;
      border-radius: 10px;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border: 1px solid var(--border-color);
    }
    
    .chat-info {
      display: flex;
      align-items: center;
      gap: 10px;
      flex: 1;
    }
    
    #chat-list li:hover {
      background: #f5f5f5;
    }
    
    #chat-list li.active {
      background: #e8f5e9;
      border-color: var(--primary-light);
      color: var(--primary-dark);
      font-weight: 500;
    }
    
    .chat-icon {
      color: var(--primary-color);
    }
    
    .delete-chat {
      background: none;
      border: none;
      color: #f44336;
      cursor: pointer;
      opacity: 0.7;
      transition: opacity 0.3s;
      padding: 5px;
    }
    
    .delete-chat:hover {
      opacity: 1;
    }
    
    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø© */
    #chat-window {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 20px;
      overflow-y: auto;
      background-color: var(--background);
      background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M11 18c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm48 25c3.866 0 7-3.134 7-7s-3.134-7-7-7-7 3.134-7 7 3.134 7 7 7zm-43-7c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm63 31c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM34 90c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zm56-76c1.657 0 3-1.343 3-3s-1.343-3-3-3-3 1.343-3 3 1.343 3 3 3zM12 86c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm28-65c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm23-11c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-6 60c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm29 22c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zM32 63c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm57-13c2.76 0 5-2.24 5-5s-2.24-5-5-5-5 2.24-5 5 2.24 5 5 5zm-9-21c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM60 91c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM35 41c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2zM12 60c1.105 0 2-.895 2-2s-.895-2-2-2-2 .895-2 2 .895 2 2 2z' fill='%23e0e0e0' fill-opacity='0.1' fill-rule='evenodd'/%3E%3C/svg%3E");
    }
    
    .message {
      max-width: 85%;
      margin-bottom: 20px;
      padding: 15px 20px;
      border-radius: 18px;
      font-size: 16px;
      line-height: 1.5;
      position: relative;
      animation: fadeIn 0.3s ease;
      box-shadow: var(--shadow);
      transition: transform 0.2s ease;
    }
    
    .message:hover {
      transform: translateY(-2px);
    }
    
    .message.user {
      background: var(--user-message);
      align-self: flex-end;
      border-bottom-right-radius: 0;
    }
    
    .message.bot {
      background: var(--bot-message);
      align-self: flex-start;
      border-bottom-left-radius: 0;
      border: 1px solid var(--border-color);
    }
    
    .message-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      padding-bottom: 5px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    }
    
    .message-sender {
      font-weight: 700;
      font-size: 0.9rem;
    }
    
    .message-time {
      font-size: 0.75rem;
      color: var(--text-secondary);
    }
    
    .message-content {
      padding: 5px 0;
    }
    
    /* Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø­Ø³Ù†Ø© */
    #input-area {
      display: flex;
      align-items: center;
      padding: 15px;
      border-top: 1px solid var(--border-color);
      background-color: white;
      gap: 10px;
      position: relative;
    }
    
    #input-area .input-group {
      display: flex;
      flex: 1;
      background: #f5f5f5;
      border-radius: 25px;
      padding: 5px 15px;
      align-items: center;
    }
    
    #input-area input[type="text"] {
      flex: 1;
      padding: 12px 10px;
      border: none;
      background: transparent;
      font-size: 16px;
      outline: none;
      direction: rtl;
    }
    
    .input-actions {
      display: flex;
      gap: 5px;
    }
    
    .input-btn {
      background: transparent;
      border: none;
      color: var(--text-secondary);
      width: 40px;
      height: 40px;
      font-size: 20px;
      cursor: pointer;
      border-radius: 50%;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .input-btn:hover {
      background: #e0e0e0;
      color: var(--primary-color);
    }
    
    #send-btn {
      background: var(--primary-color);
      color: white;
    }
    
    #send-btn:hover {
      background: var(--primary-dark);
      transform: scale(1.05);
    }
    
    /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø­Ø³Ù†Ø© */
    #dropdown {
      position: fixed;
      bottom: 85px;
      right: 30px;
      background: white;
      border: 1px solid var(--border-color);
      border-radius: 12px;
      display: none;
      flex-direction: column;
      width: 220px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      z-index: 200;
      overflow: hidden;
    }
    
    #dropdown button {
      background: none;
      border: none;
      padding: 12px 20px;
      font-size: 16px;
      text-align: right;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.2s ease;
    }
    
    #dropdown button:hover {
      background: #f5f5f5;
    }
    
    #dropdown button i {
      font-size: 18px;
      width: 24px;
      text-align: center;
    }
    
    /* Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø© */
    pre {
      background: #2d2d2d;
      color: #f8f8f2;
      padding: 40px 15px 15px 15px;
      border-radius: 8px;
      overflow-x: auto;
      font-size: 14px;
      margin: 15px 0;
      position: relative;
      direction: ltr;
      text-align: left;
      box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
    }
    
    .code-header {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      background: #1e1e1e;
      padding: 8px 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-top-left-radius: 8px;
      border-top-right-radius: 8px;
    }
    
    .language-tag {
      font-size: 12px;
      color: #aaa;
      text-transform: uppercase;
    }
    
    .copy-btn {
      background: #128c7e;
      border: none;
      color: white;
      border-radius: 4px;
      padding: 4px 10px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .copy-btn:hover {
      background: #075e54;
    }
    
    /* Ù…Ø¤Ø´Ø± Ø§Ù„ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù…ØªØ­Ø±Ùƒ */
    .typing-indicator {
      display: inline-flex;
      align-items: center;
      background: var(--bot-message);
      border: 1px solid var(--border-color);
      padding: 10px 20px;
      border-radius: 18px;
      border-bottom-left-radius: 0;
      box-shadow: var(--shadow);
    }
    
    .typing-indicator span {
      width: 8px;
      height: 8px;
      background-color: #999;
      border-radius: 50%;
      display: inline-block;
      margin: 0 2px;
      animation: typing 1s infinite;
    }
    
    .typing-indicator span:nth-child(2) {
      animation-delay: 0.2s;
    }
    
    .typing-indicator span:nth-child(3) {
      animation-delay: 0.4s;
    }
    
    @keyframes typing {
      0%, 60%, 100% { transform: translateY(0); }
      30% { transform: translateY(-5px); }
    }
    
    /* ØªØ£Ø«ÙŠØ±Ø§Øª Ù…ØªØ­Ø±ÙƒØ© */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .pulse {
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    /* Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ */
    .welcome-message {
      text-align: center;
      max-width: 600px;
      margin: auto;
      padding: 30px;
      animation: fadeIn 0.5s ease;
    }
    
    .welcome-message h2 {
      font-size: 2rem;
      margin-bottom: 20px;
      color: var(--primary-dark);
    }
    
    .welcome-message p {
      font-size: 1.1rem;
      line-height: 1.6;
      margin-bottom: 25px;
      color: var(--text-secondary);
    }
    
    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 30px;
    }
    
    .feature {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: var(--shadow);
      text-align: center;
      transition: all 0.3s ease;
    }
    
    .feature:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    .feature i {
      font-size: 2.5rem;
      color: var(--primary-color);
      margin-bottom: 15px;
    }
    
    .feature h3 {
      margin-bottom: 10px;
      color: var(--primary-dark);
    }
    
    .feature p {
      font-size: 0.9rem;
    }
    
    /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª */
    #settings-modal {
      display: none;
      position: fixed;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }
    
    .settings-content {
      background: white;
      width: 90%;
      max-width: 500px;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    
    .settings-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .settings-header h2 {
      font-size: 1.5rem;
      color: var(--primary-dark);
    }
    
    .close-settings {
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--text-secondary);
      cursor: pointer;
    }
    
    .settings-body {
      margin-bottom: 20px;
    }
    
    .form-group {
      margin-bottom: 15px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 5px;
      font-weight: 500;
    }
    
    .form-group input {
      width: 100%;
      padding: 10px;
      border: 1px solid var(--border-color);
      border-radius: 6px;
      font-size: 16px;
    }
    
    .settings-footer {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }
    
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    
    .btn-primary {
      background: var(--primary-color);
      color: white;
    }
    
    .btn-primary:hover {
      background: var(--primary-dark);
    }
    
    .btn-secondary {
      background: #f5f5f5;
      color: var(--text-primary);
    }
    
    .btn-secondary:hover {
      background: #e0e0e0;
    }
    
    /* Ù…Ø¹Ø±Ø¶ Ø§Ù„ØªØ¹Ø¨ÙŠØ±Ø§Øª */
    #emoji-container {
      position: absolute;
      bottom: 70px;
      right: 60px;
      z-index: 100;
      display: none;
      background: white;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      padding: 15px;
      width: 300px;
      height: 250px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
    }
    
    .emoji-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
    }
    
    .emoji-item {
      font-size: 1.5rem;
      cursor: pointer;
      text-align: center;
      padding: 5px;
      transition: all 0.2s ease;
      border-radius: 6px;
    }
    
    .emoji-item:hover {
      background: #f0f0f0;
      transform: scale(1.2);
    }
    
    /* Ø§Ù„ØªÙƒÙŠÙ Ù…Ø¹ Ø§Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© */
    @media (max-width: 768px) {
      #app {
        border-radius: 0;
      }
      
      header {
        padding: 0 15px;
      }
      
      .app-title h1 {
        font-size: 1.2rem;
      }
      
      .message {
        max-width: 90%;
      }
      
      .welcome-message {
        padding: 20px;
      }
      
      .features {
        grid-template-columns: 1fr;
      }
      
      #emoji-container {
        right: 10px;
        width: 280px;
      }
    }
  </style>
</head>
<body>
  <div id="app">
    <header>
      <div class="header-left">
        <div class="logo">
          <i class="fas fa-robot"></i>
        </div>
        <div class="app-title">
          <h1>Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h1>
          <p>Ù†Ø³Ø®Ø© Ø§Ø­ØªØ±Ø§ÙÙŠØ© - Ù…ØªØ·ÙˆØ±</p>
        </div>
      </div>
      <div class="header-actions">
        <button class="header-btn" title="ÙØªØ­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª" onclick="toggleSidebar()">
          <i class="fas fa-comments"></i>
        </button>
        <button class="header-btn" title="Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª" onclick="openSettings()">
          <i class="fas fa-cog"></i>
        </button>
      </div>
    </header>

    <aside id="sidebar">
      <div class="sidebar-header">
        <h2>Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</h2>
        <button class="close-sidebar" onclick="toggleSidebar()">&times;</button>
      </div>
      <button id="new-chat-btn" onclick="startNewChat()">
        <i class="fas fa-plus"></i> Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©
      </button>
      <ul id="chat-list"></ul>
    </aside>

    <main id="chat-window">
      <div class="welcome-message">
        <h2>Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h2>
        <p>Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù…ØªØ·ÙˆØ± ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø£Ø³Ø¦Ù„ØªÙƒØŒ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©ØŒ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§ØªØŒ ÙˆØ§Ù„Ø¹Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø£Ø®Ø±Ù‰. Ø§Ø¨Ø¯Ø£ Ø¨Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„ Ø£Ùˆ Ø¬Ø±Ø¨ Ø£Ø­Ø¯ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©.</p>
        
        <div class="features">
          <div class="feature">
            <i class="fas fa-code"></i>
            <h3>Ø¨Ø±Ù…Ø¬Ø© Ù…ØªÙ‚Ø¯Ù…Ø©</h3>
            <p>Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ ÙƒØªØ§Ø¨Ø© ÙˆØªØµØ­ÙŠØ­ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©</p>
          </div>
          <div class="feature">
            <i class="fas fa-file-alt"></i>
            <h3>ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª</h3>
            <p>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ù„ØªØ­Ù„ÙŠÙ„ Ù…Ø­ØªÙˆØ§Ù‡Ø§</p>
          </div>
          <div class="feature">
            <i class="fas fa-language"></i>
            <h3>ØªØ±Ø¬Ù…Ø© ÙÙˆØ±ÙŠØ©</h3>
            <p>ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù†ØµÙˆØµ Ø¨ÙŠÙ† Ø§Ù„Ù„ØºØ§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ©</p>
          </div>
          <div class="feature">
            <i class="fas fa-brain"></i>
            <h3>Ø°ÙƒØ§Ø¡ Ù…ØªØ·ÙˆØ±</h3>
            <p>Ø¥Ø¬Ø§Ø¨Ø§Øª Ø¯Ù‚ÙŠÙ‚Ø© Ø¹Ù„Ù‰ Ø£Ø³Ø¦Ù„ØªÙƒ Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©</p>
          </div>
        </div>
      </div>
    </main>

    <div id="input-area">
      <div class="input-group">
        <input
          type="text"
          id="prompt"
          placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..."
          onkeypress="if(event.key === 'Enter') sendMessage()"
        />
        <div class="input-actions">
          <button class="input-btn" title="Ù…Ø¹Ø±Ø¶ Ø§Ù„ØªØ¹Ø¨ÙŠØ±Ø§Øª" onclick="toggleEmojiPicker()">
            <i class="far fa-smile"></i>
          </button>
          <button class="input-btn" title="Ø±ÙØ¹ Ù…Ù„Ù" onclick="togglePlusMenu()">
            <i class="fas fa-paperclip"></i>
          </button>
        </div>
      </div>
      <button id="send-btn" class="input-btn" onclick="sendMessage()">
        <i class="fas fa-paper-plane"></i>
      </button>
    </div>

    <div id="dropdown">
      <button onclick="uploadFile('document')">
        <i class="fas fa-file-pdf"></i> Ø±ÙØ¹ Ù…Ø³ØªÙ†Ø¯ PDF
      </button>
      <button onclick="uploadFile('image')">
        <i class="fas fa-image"></i> Ø±ÙØ¹ ØµÙˆØ±Ø©
      </button>
      <button onclick="uploadFile('audio')">
        <i class="fas fa-microphone"></i> ØªØ³Ø¬ÙŠÙ„ ØµÙˆØªÙŠ
      </button>
      <button onclick="uploadFile('spreadsheet')">
        <i class="fas fa-file-excel"></i> Ø±ÙØ¹ Ø¬Ø¯ÙˆÙ„ Ø¨ÙŠØ§Ù†Ø§Øª
      </button>
    </div>

    <!-- ØªØ¹Ø¯ÙŠÙ„ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù„ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ "Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ" --><div id="settings-modal">
  <div class="settings-content">
    <div class="settings-header">
      <h2>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h2>
      <button class="close-settings" onclick="closeSettings()">&times;</button>
    </div><div class="settings-body">
  <!-- Ù‚Ø§Ø¦Ù…Ø© ØªØ¨ÙˆÙŠØ¨Ø§Øª -->
  <div class="form-group">
    <button class="btn btn-secondary" onclick="showProfileSettings()">Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ</button>
    <button class="btn btn-secondary" onclick="showApiSettings()">ØªØºÙŠÙŠØ± Ø§Ù„Ù€ API</button>
  </div>

  <!-- ØªØ¨ÙˆÙŠØ¨: Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ -->
  <div id="profile-settings" style="display:none;">
    <div style="text-align:center; margin-bottom: 20px;">
      <div onclick="promptForImage()" style="width:100px;height:100px;border-radius:50%;background:#eee;overflow:hidden;margin:auto;position:relative;cursor:pointer">
        <img id="profile-image" src="" style="width:100%;height:100%;object-fit:cover;display:none">
        <span id="plus-icon" style="position:absolute;bottom:5px;left:5px;font-size:24px;color:#888;background:#fff;border-radius:50%;width:24px;height:24px;display:flex;align-items:center;justify-content:center;box-shadow:0 0 5px rgba(0,0,0,0.2)">+</span>
      </div>
    </div>
    <div class="form-group">
      <label>Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„:</label>
      <input type="text" id="full-name" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„">
    </div>
    <div class="form-group">
      <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</label>
      <input type="text" id="username" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…">
    </div>
    <div class="form-group">
      <label>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ:</label>
      <input type="email" id="email" placeholder="Ø§Ø¯Ø®Ù„ Ø¨Ø±ÙŠØ¯Ùƒ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ">
    </div>
  </div>

  <!-- ØªØ¨ÙˆÙŠØ¨: ØªØºÙŠÙŠØ± API -->
  <div id="api-settings" style="display:none;">
    <div class="form-group">
      <label for="api-key">Ù…ÙØªØ§Ø­ API:</label>
      <input type="password" id="api-key" placeholder="Ø£Ø¯Ø®Ù„ Ù…ÙØªØ§Ø­ API Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ">
    </div>
  </div>
</div>

<div class="settings-footer">
  <button class="btn btn-secondary" onclick="closeSettings()">Ø¥Ù„ØºØ§Ø¡</button>
  <button class="btn btn-primary" onclick="saveSettings()">Ø­ÙØ¸</button>
</div>

  </div>
</div><script>
  function openSettings() {
    document.getElementById('settings-modal').style.display = 'flex';
    document.getElementById('api-key').value = apiKey;
    showProfileSettings();
  }

  function showProfileSettings() {
    document.getElementById('profile-settings').style.display = 'block';
    document.getElementById('api-settings').style.display = 'none';
  }

  function showApiSettings() {
    document.getElementById('profile-settings').style.display = 'none';
    document.getElementById('api-settings').style.display = 'block';
  }

  function promptForImage() {
    const url = prompt("Ø£Ø¯Ø®Ù„ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©:");
    if (url) {
      const img = document.getElementById('profile-image');
      img.src = url;
      img.style.display = 'block';
      document.getElementById('plus-icon').style.display = 'none';
    }
  }

  function saveSettings() {
    localStorage.setItem("fullName", document.getElementById("full-name").value);
    localStorage.setItem("username", document.getElementById("username").value);
    localStorage.setItem("email", document.getElementById("email").value);
    localStorage.setItem("profileImage", document.getElementById("profile-image").src);
    apiKey = document.getElementById('api-key').value;
    localStorage.setItem('apiKey', apiKey);
    closeSettings();
    alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!");
  }

  function loadProfile() {
    document.getElementById("full-name").value = localStorage.getItem("fullName") || "";
    document.getElementById("username").value = localStorage.getItem("username") || "";
    document.getElementById("email").value = localStorage.getItem("email") || "";
    const img = localStorage.getItem("profileImage");
    if (img) {
      document.getElementById("profile-image").src = img;
      document.getElementById("profile-image").style.display = 'block';
      document.getElementById("plus-icon").style.display = 'none';
    }
  }

  document.addEventListener("DOMContentLoaded", loadProfile);
</script><!-- Ù†Ø³Ø® Ø§Ù„Ø´ÙŠÙØ±Ø© Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ© ÙˆØ§Ù„Ø±Ø³Ø§Ø¦Ù„ --><style>
  .code-header {
    position: absolute;
    top: 0;
    right: 0;
    padding: 5px 10px;
    z-index: 1;
  }

  .copy-btn {
    background: #128c7e;
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 12px;
    padding: 4px 8px;
    cursor: pointer;
    transition: 0.2s;
  }

  .copy-btn:hover {
    background: #0e6e61;
  }

  .message {
    position: relative;
  }

  .message .message-copy-btn {
    position: absolute;
    top: 5px;
    left: 10px;
    background: none;
    border: none;
    color: #888;
    cursor: pointer;
    font-size: 16px;
    transition: color 0.3s;
  }

  .message .message-copy-btn:hover {
    color: #128c7e;
  }
</style><script>
  function copyCode(button) {
    const code = button.closest('.code-header').nextElementSibling.textContent;
    navigator.clipboard.writeText(code).then(() => {
      const originalText = button.innerHTML;
      button.innerHTML = 'ØªÙ… Ø§Ù„Ù†Ø³Ø®!';
      setTimeout(() => {
        button.innerHTML = originalText;
      }, 2000);
    });
  }

  function copyMessage(button) {
    const msg = button.closest('.message').querySelector('.message-content').innerText;
    navigator.clipboard.writeText(msg).then(() => {
      const original = button.innerHTML;
      button.innerHTML = '<i class="fas fa-check"></i>';
      setTimeout(() => button.innerHTML = '<i class="fas fa-copy"></i>', 2000);
    });
  }
</script>
    <!-- Ù…Ø¹Ø±Ø¶ Ø§Ù„ØªØ¹Ø¨ÙŠØ±Ø§Øª -->
    <div id="emoji-container">
      <div class="emoji-grid" id="emoji-grid"></div>
    </div>
  </div>

  <!-- Ù…ÙƒØªØ¨Ø© Ø§Ù„ØªÙ…ÙŠÙŠØ² Ø§Ù„Ù„ÙˆÙ†ÙŠ -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css"
  />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
  <script>
    let chats = [];
    let currentChatId = null;
    let apiKey = localStorage.getItem('apiKey') || "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";
    
    // Ø¯Ø§Ù„Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¹Ø±Ù Ø¹Ø´ÙˆØ§Ø¦ÙŠ
    function generateId() {
      return Math.random().toString(36).substr(2, 9);
    }
    
    // Ø¯Ø§Ù„Ø© Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙˆÙ‚Øª
    function formatTime(date = new Date()) {
      return date.toLocaleTimeString('ar-EG', { hour: '2-digit', minute: '2-digit' });
    }

    document.addEventListener("DOMContentLoaded", () => {
      <!-- startNewChat(); -->
      initEmojis();
      
      // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
      document.addEventListener("click", function (event) {
        const sidebar = document.getElementById("sidebar");
        const dropdown = document.getElementById("dropdown");
        const settingsModal = document.getElementById("settings-modal");
        const emojiContainer = document.getElementById("emoji-container");
        const menuBtn = document.querySelector(".header-btn");
        const plusBtn = document.querySelector(".fa-paperclip").closest(".input-btn");
        const emojiBtn = document.querySelector(".fa-smile").closest(".input-btn");
        
        if (sidebar.classList.contains("visible") && 
            !sidebar.contains(event.target) && 
            !menuBtn.contains(event.target)) {
          sidebar.classList.remove("visible");
        }
        
        if (dropdown.style.display === "flex" && 
            !dropdown.contains(event.target) && 
            !plusBtn.contains(event.target)) {
          dropdown.style.display = "none";
        }
        
        if (settingsModal.style.display === "flex" && 
            event.target === settingsModal) {
          closeSettings();
        }
        
        if (emojiContainer.style.display === "block" && 
            !emojiContainer.contains(event.target) && 
            !emojiBtn.contains(event.target)) {
          emojiContainer.style.display = "none";
        }
      });
    });

    function toggleSidebar() {
      const sidebar = document.getElementById("sidebar");
      sidebar.classList.toggle("visible");
    }

    function togglePlusMenu() {
      const dropdown = document.getElementById("dropdown");
      dropdown.style.display = dropdown.style.display === "flex" ? "none" : "flex";
    }
    
    function toggleEmojiPicker() {
      const emojiContainer = document.getElementById("emoji-container");
      emojiContainer.style.display = emojiContainer.style.display === "block" ? "none" : "block";
    }
    
    // ØªÙ‡ÙŠØ¦Ø© Ù…Ø¹Ø±Ø¶ Ø§Ù„ØªØ¹Ø¨ÙŠØ±Ø§Øª
    function initEmojis() {
      const emojis = [
        "ğŸ˜€", "ğŸ˜ƒ", "ğŸ˜„", "ğŸ˜", "ğŸ˜†", "ğŸ˜…", "ğŸ˜‚", "ğŸ¤£", "ğŸ˜Š", "ğŸ˜‡", 
        "ğŸ™‚", "ğŸ™ƒ", "ğŸ˜‰", "ğŸ˜Œ", "ğŸ˜", "ğŸ¥°", "ğŸ˜˜", "ğŸ˜—", "ğŸ˜™", "ğŸ˜š", 
        "ğŸ˜‹", "ğŸ˜›", "ğŸ˜", "ğŸ˜œ", "ğŸ¤ª", "ğŸ¤¨", "ğŸ§", "ğŸ¤“", "ğŸ˜", "ğŸ¤©", 
        "ğŸ¥³", "ğŸ˜", "ğŸ˜’", "ğŸ˜", "ğŸ˜”", "ğŸ˜Ÿ", "ğŸ˜•", "ğŸ™", "â˜¹ï¸", "ğŸ˜£", 
        "ğŸ˜–", "ğŸ˜«", "ğŸ˜©", "ğŸ¥º", "ğŸ˜¢", "ğŸ˜­", "ğŸ˜¤", "ğŸ˜ ", "ğŸ˜¡", "ğŸ¤¬", 
        "ğŸ¤¯", "ğŸ˜³", "ğŸ¥µ", "ğŸ¥¶", "ğŸ˜±", "ğŸ˜¨", "ğŸ˜°", "ğŸ˜¥", "ğŸ˜“", "ğŸ¤—", 
        "ğŸ¤”", "ğŸ¤­", "ğŸ¤«", "ğŸ¤¥", "ğŸ˜¶", "ğŸ˜", "ğŸ˜‘", "ğŸ˜¬", "ğŸ™„", "ğŸ˜¯", 
        "ğŸ˜¦", "ğŸ˜§", "ğŸ˜®", "ğŸ˜²", "ğŸ¥±", "ğŸ˜´", "ğŸ¤¤", "ğŸ˜ª", "ğŸ˜µ", "ğŸ¤", 
        "ğŸ¥´", "ğŸ¤¢", "ğŸ¤®", "ğŸ¤§", "ğŸ˜·", "ğŸ¤’", "ğŸ¤•", "ğŸ¤‘", "ğŸ¤ ", "ğŸ˜ˆ", 
        "ğŸ‘¿", "ğŸ‘¹", "ğŸ‘º", "ğŸ¤¡", "ğŸ’©", "ğŸ‘»", "ğŸ’€", "â˜ ï¸", "ğŸ‘½", "ğŸ‘¾", 
        "ğŸ¤–", "ğŸƒ", "ğŸ˜º", "ğŸ˜¸", "ğŸ˜¹", "ğŸ˜»", "ğŸ˜¼", "ğŸ˜½", "ğŸ™€", "ğŸ˜¿", 
        "ğŸ˜¾", "ğŸ‘‹", "ğŸ¤š", "ğŸ–", "âœ‹", "ğŸ––", "ğŸ‘Œ", "ğŸ¤", "âœŒï¸", "ğŸ¤", 
        "ğŸ¤Ÿ", "ğŸ¤˜", "ğŸ¤™", "ğŸ‘ˆ", "ğŸ‘‰", "ğŸ‘†", "ğŸ–•", "ğŸ‘‡", "â˜ï¸", "ğŸ‘", 
        "ğŸ‘", "âœŠ", "ğŸ‘Š", "ğŸ¤›", "ğŸ¤œ", "ğŸ‘", "ğŸ™Œ", "ğŸ‘", "ğŸ¤²", "ğŸ¤", 
        "ğŸ™", "âœï¸", "ğŸ’…", "ğŸ¤³", "ğŸ’ª", "ğŸ¦¾", "ğŸ¦¿", "ğŸ¦µ", "ğŸ¦¶", "ğŸ‘‚", 
        "ğŸ¦»", "ğŸ‘ƒ", "ğŸ§ ", "ğŸ¦·", "ğŸ¦´", "ğŸ‘€", "ğŸ‘", "ğŸ‘…", "ğŸ‘„", "ğŸ’‹", 
        "ğŸ©¸", "ğŸ’˜", "â¤ï¸", "ğŸ’“", "ğŸ’”", "ğŸ’•", "ğŸ’–", "ğŸ’—", "ğŸ’™", "ğŸ’š", 
        "ğŸ’›", "ğŸ’œ", "ğŸ–¤", "ğŸ’", "ğŸ’", "ğŸ’Ÿ", "â£ï¸", "ğŸ’Œ", "ğŸ’¤", "ğŸ’¢", 
        "ğŸ’£", "ğŸ’¥", "ğŸ’¦", "ğŸ’¨", "ğŸ’«", "ğŸ’¬", "ğŸ‘ï¸â€ğŸ—¨ï¸", "ğŸ—¨ï¸", "ğŸ—¯ï¸", "ğŸ’­", 
        "ğŸ•³ï¸", "ğŸ‘“", "ğŸ•¶ï¸", "ğŸ¥½", "ğŸ¥¼", "ğŸ¦º", "ğŸ‘”", "ğŸ‘•", "ğŸ‘–", "ğŸ§£", 
        "ğŸ§¤", "ğŸ§¥", "ğŸ§¦", "ğŸ‘—", "ğŸ‘˜", "ğŸ¥»", "ğŸ©±", "ğŸ©²", "ğŸ©³", "ğŸ‘™", 
        "ğŸ‘š", "ğŸ‘›", "ğŸ‘œ", "ğŸ‘", "ğŸ’", "ğŸ‘", "ğŸ‘Ÿ", "ğŸ¥¾", "ğŸ¥¿", "ğŸ‘ ", 
        "ğŸ‘¡", "ğŸ©°", "ğŸ‘¢", "ğŸ‘‘", "ğŸ‘’", "ğŸ©", "ğŸ“", "ğŸ§¢", "â›‘ï¸", "ğŸ’„", 
        "ğŸ’", "ğŸ’¼"
      ];
      
      const emojiGrid = document.getElementById("emoji-grid");
      emojis.forEach(emoji => {
        const emojiItem = document.createElement("div");
        emojiItem.className = "emoji-item";
        emojiItem.textContent = emoji;
        emojiItem.onclick = () => {
          document.getElementById("prompt").value += emoji;
          document.getElementById("emoji-container").style.display = "none";
        };
        emojiGrid.appendChild(emojiItem);
      });
    }
    
    function openSettings() {
      document.getElementById('settings-modal').style.display = 'flex';
      document.getElementById('api-key').value = apiKey;
    }
    
    function closeSettings() {
      document.getElementById('settings-modal').style.display = 'none';
    }
    
    function saveApiKey() {
      apiKey = document.getElementById('api-key').value;
      localStorage.setItem('apiKey', apiKey);
      closeSettings();
      alert('ØªÙ… Ø­ÙØ¸ Ù…ÙØªØ§Ø­ API Ø¨Ù†Ø¬Ø§Ø­!');
    }

    function startNewChat() {
      const chatId = generateId();
      chats.push({ id: chatId, messages: [], title: "Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©" });
      currentChatId = chatId;
      updateChatList();
      renderMessages();
      
      // Ø§Ù„Ø­Ù„: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¹Ù†ØµØ± Ù‚Ø¨Ù„ ØªØ¹Ø¯ÙŠÙ„Ù‡
      const welcomeMessage = document.querySelector('.welcome-message');
      if (welcomeMessage) {
        welcomeMessage.style.display = 'none';
      }
    }

    function updateChatList() {
      const list = document.getElementById("chat-list");
      list.innerHTML = "";
      
      chats.slice().reverse().forEach((chat) => {
        const li = document.createElement("li");
        li.innerHTML = `
          <div class="chat-info">
            <i class="fas fa-comment chat-icon"></i>
            <span>${chat.title}</span>
          </div>
          <button class="delete-chat" title="Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©" onclick="deleteChat('${chat.id}')">
            <i class="fas fa-trash"></i>
          </button>
        `;
        li.className = currentChatId === chat.id ? "active" : "";
        li.onclick = (e) => {
          // ØªØ¬Ù†Ø¨ ØªÙ†ÙÙŠØ° Ø§Ù„Ø­Ø°Ù Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø²Ø± Ø§Ù„Ø­Ø°Ù
          if (!e.target.closest('.delete-chat')) {
            currentChatId = chat.id;
            renderMessages();
            toggleSidebar();
            
            // Ø§Ù„Ø­Ù„: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¹Ù†ØµØ± Ù‚Ø¨Ù„ ØªØ¹Ø¯ÙŠÙ„Ù‡
            const welcomeMessage = document.querySelector('.welcome-message');
            if (welcomeMessage) {
              welcomeMessage.style.display = 'none';
            }
          }
        };
        list.appendChild(li);
      });
    }
    function deleteChat(chatId) {
      if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©ØŸ')) {
        chats = chats.filter(chat => chat.id !== chatId);
        
        // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ù…Ø­Ø°ÙˆÙØ© Ù‡ÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠØ©ØŒ Ù†Ø¨Ø¯Ø£ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©
        if (currentChatId === chatId) {
          if (chats.length > 0) {
            currentChatId = chats[chats.length - 1].id;
          } else {
            startNewChat();
          }
        }
        
        updateChatList();
        renderMessages();
      }
    }

    function renderMessages() {
      const chatWindow = document.getElementById("chat-window");
      
      // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø±Ø³Ø§Ø¦Ù„
      const chat = chats.find((c) => c.id === currentChatId);
      if (!chat || chat.messages.length === 0) {
        chatWindow.innerHTML = `
          <div class="welcome-message">
            <h2>Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h2>
            <p>Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù…ØªØ·ÙˆØ± ÙŠÙ…ÙƒÙ†Ù‡ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø¹Ù„Ù‰ Ø£Ø³Ø¦Ù„ØªÙƒØŒ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©ØŒ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§ØªØŒ ÙˆØ§Ù„Ø¹Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ø£Ø®Ø±Ù‰. Ø§Ø¨Ø¯Ø£ Ø¨Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„ Ø£Ùˆ Ø¬Ø±Ø¨ Ø£Ø­Ø¯ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©.</p>
            
            <div class="features">
              <div class="feature">
                <i class="fas fa-code"></i>
                <h3>Ø¨Ø±Ù…Ø¬Ø© Ù…ØªÙ‚Ø¯Ù…Ø©</h3>
                <p>Ù…Ø³Ø§Ø¹Ø¯Ø© ÙÙŠ ÙƒØªØ§Ø¨Ø© ÙˆØªØµØ­ÙŠØ­ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©</p>
              </div>
              <div class="feature">
                <i class="fas fa-file-alt"></i>
                <h3>ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª</h3>
                <p>ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙ†Ø¯Ø§Øª Ù„ØªØ­Ù„ÙŠÙ„ Ù…Ø­ØªÙˆØ§Ù‡Ø§</p>
              </div>
              <div class="feature">
                <i class="fas fa-language"></i>
                <h3>ØªØ±Ø¬Ù…Ø© ÙÙˆØ±ÙŠØ©</h3>
                <p>ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù†ØµÙˆØµ Ø¨ÙŠÙ† Ø§Ù„Ù„ØºØ§Øª Ø§Ù„Ù…Ø®ØªÙ„ÙØ©</p>
              </div>
              <div class="feature">
                <i class="fas fa-brain"></i>
                <h3>Ø°ÙƒØ§Ø¡ Ù…ØªØ·ÙˆØ±</h3>
                <p>Ø¥Ø¬Ø§Ø¨Ø§Øª Ø¯Ù‚ÙŠÙ‚Ø© Ø¹Ù„Ù‰ Ø£Ø³Ø¦Ù„ØªÙƒ Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©</p>
              </div>
            </div>
          </div>
        `;
        return;
      }

      chatWindow.innerHTML = "";
      
      chat.messages.forEach((msg) => {
        const div = document.createElement("div");
        div.className = `message ${msg.role}`;
        
        if (msg.role === 'assistant' && msg.content === "Ø¬Ø§Ø±Ù Ø§Ù„ÙƒØªØ§Ø¨Ø©...") {
          div.className = "message bot";
          div.innerHTML = `
            <div class="typing-indicator">
              <span></span>
              <span></span>
              <span></span>
            </div>
          `;
        } else {
          div.innerHTML = `
            <div class="message-header">
              <div class="message-sender">
                ${msg.role === 'user' ? 'Ø£Ù†Øª' : 'Taiz Soft'}
              </div>
              <div class="message-time">${formatTime(msg.timestamp)}</div>
            </div>
            <div class="message-content">
              ${formatMessageContent(msg.content)}
            </div>
          `;
        }
        
        chatWindow.appendChild(div);
      });

      // ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø´Ø§Ø´Ø© Ù„Ø£Ø³ÙÙ„ Ù„Ø¹Ø±Ø¶ Ø¢Ø®Ø± Ø±Ø³Ø§Ù„Ø©
      chatWindow.scrollTop = chatWindow.scrollHeight;
    }
    
    function formatMessageContent(content) {
      // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£ÙƒÙˆØ§Ø¯ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ©
      if (/```[\s\S]*?```/.test(content)) {
        const codeBlocks = content.match(/```(\w*)\n([\s\S]*?)```/g);
        let formattedContent = content;
        
        codeBlocks.forEach((block) => {
          const langMatch = block.match(/```(\w*)\n/);
          const lang = langMatch ? langMatch[1] : 'text';
          const codeText = block.replace(/```(\w*)\n/, '').replace(/```$/, '');
          
          const codeBlock = `
            <div style="position: relative; margin: 15px 0;">
              <div class="code-header">
                <span class="language-tag">${lang}</span>
                <button class="copy-btn" onclick="copyCode(this)">
                  <i class="fas fa-copy"></i> Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯
                </button>
              </div>
              <pre><code class="language-${lang}">${escapeHtml(codeText)}</code></pre>
            </div>
          `;
          
          formattedContent = formattedContent.replace(block, codeBlock);
        });
        
        return formattedContent;
      }
      
      return content.replace(/\n/g, '<br>');
    }
    
    function escapeHtml(unsafe) {
      return unsafe
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
    }
    
    function copyCode(button) {
      const code = button.closest('.code-header').nextElementSibling.textContent;
      navigator.clipboard.writeText(code).then(() => {
        const originalText = button.innerHTML;
        button.innerHTML = '<i class="fas fa-check"></i> ØªÙ… Ø§Ù„Ù†Ø³Ø®!';
        setTimeout(() => {
          button.innerHTML = originalText;
        }, 2000);
      });
    }

    async function sendMessage(customPrompt = null) {
      const input = document.getElementById("prompt");
      const prompt = customPrompt || input.value.trim();
      if (!prompt) return;
      input.value = "";

      if (!currentChatId) {
  startNewChat(); // â† Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø© Ø¹Ù†Ø¯ Ø£ÙˆÙ„ Ø±Ø³Ø§Ù„Ø©
}
const chat = chats.find((c) => c.id === currentChatId);
      chat.messages.push({ 
        role: "user", 
        content: prompt,
        timestamp: new Date()
      });
      renderMessages();

      const typingMsg = { 
        role: "assistant", 
        content: "Ø¬Ø§Ø±Ù Ø§Ù„ÙƒØªØ§Ø¨Ø©...",
        timestamp: new Date()
      };
      chat.messages.push(typingMsg);
      renderMessages();

      try {
        const res = await fetch("https://openrouter.ai/api/v1/chat/completions", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Authorization: `Bearer ${apiKey}`,
            "HTTP-Referer": "https://example.com",
            "X-Title": "AI-Test",
          },
          body: JSON.stringify({
            model: "openai/gpt-4o",
            messages: chat.messages
              .filter(m => m.role !== 'assistant' || m.content !== "Ø¬Ø§Ø±Ù Ø§Ù„ÙƒØªØ§Ø¨Ø©...")
              .map(({role, content}) => ({ role, content })),
            max_tokens: 500,
          }),
        });

        const data = await res.json();
        const content = data.choices?.[0]?.message?.content || "Ù„Ù… Ø£ØªÙ…ÙƒÙ† Ù…Ù† Ø¥ÙŠØ¬Ø§Ø¯ Ø±Ø¯ Ù…Ù†Ø§Ø³Ø¨.";

        chat.messages.pop(); // Ø¥Ø²Ø§Ù„Ø© "Ø¬Ø§Ø±Ù Ø§Ù„ÙƒØªØ§Ø¨Ø©..."
        chat.messages.push({ 
          role: "assistant", 
          content,
          timestamp: new Date()
        });

        if (chat.title === "Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©") {
          chat.title = content.slice(0, 30) + (content.length > 30 ? "..." : "");
          updateChatList();
        }

        renderMessages();
      } catch (err) {
        console.error(err);
        chat.messages.pop();
        chat.messages.push({ 
          role: "assistant", 
          content: "âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø§ØªØµØ§Ù„. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.",
          timestamp: new Date()
        });
        renderMessages();
        
        }
    }
    
    function uploadFile(type) {
      togglePlusMenu();
      
      let message;
      switch (type) {
        case 'document':
          message = "ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ Ø¨Ù†Ø¬Ø§Ø­. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ ØªØ­Ù„ÙŠÙ„Ù‡ØŸ";
          break;
        case 'image':
          message = "ØªÙ… Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ ÙˆØµÙÙ‡Ø§ Ø£Ùˆ ØªØ­Ù„ÙŠÙ„Ù‡Ø§ØŸ";
          break;
        case 'audio':
          message = "ØªÙ… Ø±ÙØ¹ Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ØµÙˆØªÙŠ Ø¨Ù†Ø¬Ø§Ø­. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ ØªØ­ÙˆÙŠÙ„Ù‡ Ø¥Ù„Ù‰ Ù†Øµ Ø£Ùˆ ØªØ­Ù„ÙŠÙ„Ù‡ØŸ";
          break;
        case 'spreadsheet':
          message = "ØªÙ… Ø±ÙØ¹ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ";
          break;
        default:
          message = "ØªÙ… Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒØŸ";
      }
      
      const chat = chats.find((c) => c.id === currentChatId);
      chat.messages.push({ 
        role: "user", 
        content: `[ØªÙ… Ø±ÙØ¹ Ù…Ù„Ù Ù…Ù† Ù†ÙˆØ¹ ${type}]`,
        timestamp: new Date()
      });
      chat.messages.push({ 
        role: "assistant", 
        content: message,
        timestamp: new Date()
      });
      
      renderMessages();
    }
  </script>
  
  <script>
    // ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªÙ…ÙŠÙŠØ² Ø§Ù„Ù„ÙˆÙ†ÙŠ Ù„Ù„ØºØ§Øª ÙÙŠ Ø§Ù„Ø£ÙƒÙˆØ§Ø¯
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('pre code').forEach((block) => {
        hljs.highlightElement(block);
      });
    });
  </script>
</body>
</html>